# 分享功能和过期筛选功能实施计划

## 1. 创建共享服务和工具

- [ ] 1.1 创建过期判断服务
  - 实现统一的过期日期判断逻辑
  - 支持多种日期格式解析
  - 在 `src/services/expiration.ts` 中实现
  - _需求: 2.2, 2.3, 3.4_

- [ ] 1.2 创建分享服务
  - 封装微信分享 API 调用
  - 实现分享卡片数据生成
  - 在 `src/services/share.ts` 中实现
  - _需求: 1.1, 1.2_

- [ ]* 1.3 为过期判断服务编写属性测试
  - **属性 6: 跨页面过期判断一致性**
  - **验证: 需求 3.4**

- [ ]* 1.4 为分享服务编写属性测试
  - **属性 1: 分享卡片完整性**
  - **属性 2: 分享API调用正确性**
  - **验证: 需求 1.1, 1.2**

## 2. 实现过期筛选组件

- [ ] 2.1 创建过期筛选开关组件
  - 实现可复用的筛选开关 UI 组件
  - 支持自定义样式和回调
  - 在 `src/components/ExpiredFilter/` 中实现
  - _需求: 2.1, 3.1, 3.2_

- [ ] 2.2 实现筛选状态管理
  - 使用 React Context 或状态管理库
  - 支持跨页面状态同步
  - 在 `src/contexts/FilterContext.tsx` 中实现
  - _需求: 2.4, 3.3_

- [ ]* 2.3 为筛选状态管理编写属性测试
  - **属性 4: 筛选状态持久性**
  - **属性 7: 筛选开关状态同步**
  - **验证: 需求 2.4, 3.3**

## 3. 集成过期筛选到首页

- [ ] 3.1 在首页筛选栏添加过期筛选开关
  - 更新 `src/pages/index/index.tsx` 筛选栏 UI
  - 集成过期筛选逻辑到现有筛选系统
  - _需求: 2.1, 2.2, 2.3_

- [ ] 3.2 实现首页过期筛选逻辑
  - 更新 `getFilteredFeed` 方法支持过期筛选
  - 确保与现有筛选条件正确组合
  - _需求: 2.2, 2.3, 2.5_

- [ ] 3.3 更新首页样式
  - 为过期筛选开关添加样式
  - 确保与现有 UI 风格一致
  - 更新 `src/pages/index/index.scss`
  - _需求: 2.1_

- [ ]* 3.4 为首页筛选逻辑编写属性测试
  - **属性 3: 过期筛选一致性**
  - **属性 5: 多重筛选组合正确性**
  - **验证: 需求 2.2, 2.5**

## 4. 集成过期筛选到收藏页面

- [ ] 4.1 在收藏页面添加过期筛选开关
  - 更新 `src/pages/favorites/index.tsx`
  - 复用过期筛选组件
  - _需求: 3.1_

- [ ] 4.2 实现收藏页面过期筛选逻辑
  - 更新收藏列表筛选逻辑
  - 确保与首页行为一致
  - _需求: 3.1, 3.4_

- [ ] 4.3 更新收藏页面样式
  - 添加筛选开关样式
  - 保持页面布局一致性
  - 更新 `src/pages/favorites/index.scss`
  - _需求: 3.1_

## 5. 集成过期筛选到历史页面

- [ ] 5.1 在历史页面添加过期筛选开关
  - 更新 `src/pages/history/index.tsx`
  - 复用过期筛选组件
  - _需求: 3.2_

- [ ] 5.2 实现历史页面过期筛选逻辑
  - 更新历史列表筛选逻辑
  - 确保与其他页面行为一致
  - _需求: 3.2, 3.4_

- [ ] 5.3 更新历史页面样式
  - 添加筛选开关样式
  - 保持页面布局一致性
  - 更新 `src/pages/history/index.scss`
  - _需求: 3.2_

## 6. 实现分享功能组件

- [ ] 6.1 创建分享按钮组件
  - 实现可复用的分享按钮 UI 组件
  - 支持不同尺寸和样式
  - 在 `src/components/ShareButton/` 中实现
  - _需求: 1.1, 1.3_

- [ ] 6.2 实现分享功能逻辑
  - 集成微信分享 API
  - 实现分享成功/失败处理
  - 添加用户反馈提示
  - _需求: 1.1, 1.4, 1.5_

- [ ]* 6.3 为分享按钮组件编写单元测试
  - 测试按钮渲染和点击事件
  - 测试不同尺寸和样式
  - _需求: 1.1, 1.3_

## 7. 集成分享功能到详情页面

- [ ] 7.1 在首页详情模态框添加分享按钮
  - 更新 `src/pages/index/index.tsx` 详情页面
  - 在头部或操作区域添加分享按钮
  - _需求: 1.1, 1.3_

- [ ] 7.2 在收藏页面详情模态框添加分享按钮
  - 更新 `src/pages/favorites/index.tsx` 详情页面
  - 确保与首页体验一致
  - _需求: 1.1, 1.3_

- [ ] 7.3 在历史页面详情模态框添加分享按钮
  - 更新 `src/pages/history/index.tsx` 详情页面
  - 确保与其他页面体验一致
  - _需求: 1.1, 1.3_

- [ ] 7.4 更新详情页面样式
  - 为分享按钮添加样式
  - 确保与现有 UI 风格一致
  - 更新相关 SCSS 文件
  - _需求: 1.1_

## 8. 最终测试和优化

- [ ] 8.1 跨页面功能测试
  - 测试筛选状态在页面间的同步
  - 测试分享功能在所有页面的一致性
  - _需求: 3.3, 3.4_

- [ ]* 8.2 集成测试
  - 测试微信分享 API 集成
  - 测试筛选功能性能
  - _需求: 1.1, 2.2_

- [ ] 8.3 用户体验优化
  - 优化分享和筛选的响应速度
  - 确保所有交互提供适当反馈
  - _需求: 1.4, 1.5, 2.1_

- [ ] 8.4 最终检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户