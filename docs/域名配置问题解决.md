# 🔧 域名配置问题解决

## ❌ 问题：数据遗失错误

在配置 request 合法域名时，如果出现 **"数据遗失"** 错误提示，通常是因为：

### 原因分析

1. **域名末尾有多余的分号**
   - ❌ 错误：`https://civlywqsdzzrvsutlrxx.supabase.co;`
   - ✅ 正确：`https://civlywqsdzzrvsutlrxx.supabase.co`

2. **域名格式不正确**
   - 必须包含 `https://` 协议头
   - 不能包含路径、端口号或参数

## ✅ 解决方案

### 步骤 1：清除输入框

1. 删除输入框中的所有内容
2. 确保输入框完全清空

### 步骤 2：重新输入域名

**正确的格式：**
```
https://civlywqsdzzrvsutlrxx.supabase.co
```

**注意事项：**
- ✅ 以 `https://` 开头
- ✅ 不包含末尾的分号
- ✅ 不包含路径（如 `/rest/v1/`）
- ✅ 不包含端口号
- ✅ 不包含参数

### 步骤 3：保存配置

1. 检查域名格式是否正确
2. 点击 **"保存并提交"** 按钮
3. 等待配置生效（通常几分钟）

## 📋 完整配置示例

### 单个域名（推荐）

```
https://civlywqsdzzrvsutlrxx.supabase.co
```

### 多个域名（如果需要）

如果将来需要添加多个域名，用分号分隔：

```
https://civlywqsdzzrvsutlrxx.supabase.co;https://another-domain.com
```

**注意：** 最后一个域名后不要加分号！

## 🔍 验证配置

配置完成后，可以通过以下方式验证：

### 1. 在开发者工具中测试

```typescript
import { getEvents } from '@/utils/supabase'

// 测试连接
const testConnection = async () => {
  try {
    const events = await getEvents()
    console.log('✅ 连接成功！', events)
  } catch (error) {
    console.error('❌ 连接失败：', error)
  }
}
```

### 2. 检查网络请求

在微信开发者工具的 **"Network"** 面板中：
- 查看是否有对 `civlywqsdzzrvsutlrxx.supabase.co` 的请求
- 检查请求是否成功（状态码 200）

### 3. 查看控制台错误

如果配置不正确，可能会看到：
- `不在以下 request 合法域名列表中`
- `request:fail url not in domain list`

## ⚠️ 其他常见问题

### Q: 为什么保存后还是提示错误？

A: 检查以下几点：
1. 域名格式是否正确（包含 https://，无末尾分号）
2. 是否点击了"保存并提交"按钮
3. 等待几分钟让配置生效
4. 清除小程序缓存后重试

### Q: 开发环境可以，真机调试失败？

A: 真机调试必须配置合法域名，不能使用"不校验合法域名"选项。

### Q: 如何查看当前已配置的域名？

A: 在微信公众平台的"开发设置" → "服务器域名"中可以看到所有已配置的域名。

## 🎯 快速检查清单

- [ ] 域名以 `https://` 开头
- [ ] 域名末尾没有分号（单个域名时）
- [ ] 不包含路径、端口号或参数
- [ ] 已点击"保存并提交"
- [ ] 等待配置生效（几分钟）
- [ ] 在开发者工具中测试连接

---

按照以上步骤操作，应该可以解决"数据遗失"的问题！✅

