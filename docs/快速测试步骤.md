# ⚡ 快速测试 Supabase 连接

## 🎯 3 步快速测试

### 步骤 1：启动开发服务器

```bash
cd /Users/cissyl/Desktop/2025GMBA/1st.Sem/management\ thinking/infor_platform
npm run dev:weapp
```

### 步骤 2：在微信开发者工具中打开项目

1. 打开微信开发者工具
2. 导入项目：
   - 项目路径：选择 `dist` 目录
   - AppID：使用测试号或你的 AppID

3. **重要：** 在开发者工具中：
   - 点击右上角 **"详情"**
   - 在 **"本地设置"** 中勾选：
     - ✅ **"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"**

### 步骤 3：点击测试按钮

1. 在首页顶部，找到 **🧪** 按钮（蓝色图标）
2. 点击按钮测试连接
3. 查看结果：
   - ✅ **绿色 ✅** - 连接成功
   - ❌ **红色 ❌** - 连接失败
   - ⏳ **灰色 ⏳** - 测试中

---

## 📊 查看测试结果

### 方法 1：查看控制台（推荐）

1. 在开发者工具中，点击 **"调试器"** 标签
2. 切换到 **"Console"** 面板
3. 查看输出：

**成功示例：**
```
🧪 开始测试 Supabase 连接...
✅ Supabase 连接成功！ [...]
📊 获取到 3 条数据
```

**失败示例：**
```
🧪 开始测试 Supabase 连接...
❌ Supabase 连接失败：Error: request:fail url not in domain list
```

### 方法 2：查看 Network 面板

1. 点击 **"调试器"** → **"Network"** 标签
2. 点击测试按钮
3. 查找对 `civlywqsdzzrvsutlrxx.supabase.co` 的请求
4. 查看状态码：
   - **200** - 成功 ✅
   - **其他** - 失败 ❌

### 方法 3：查看页面提示

- 成功：显示 "连接成功！获取到 X 条数据"
- 失败：显示错误提示弹窗

---

## 🔧 如果测试失败

### 检查清单

1. ✅ **域名配置**
   - 在微信公众平台已添加：`https://civlywqsdzzrvsutlrxx.supabase.co`
   - 域名格式正确（无末尾分号）

2. ✅ **开发者工具设置**
   - 已勾选"不校验合法域名"

3. ✅ **数据库配置**
   - Supabase 项目正常运行
   - 已执行 `supabase_schema.sql` 创建表
   - 表中有测试数据

4. ✅ **代码配置**
   - `src/utils/supabase.ts` 中的 URL 和 Key 正确

---

## 💡 测试成功后

如果测试成功，你可以：

1. **查看数据**
   - 控制台会显示从数据库获取的数据
   - 可以查看数据结构是否正确

2. **替换 Mock 数据**（可选）
   ```typescript
   // 在 testSupabaseConnection 函数中，测试成功后：
   const events = await getEvents()
   const feedItems = events.map(convertEventToFeedItem)
   setFeed(feedItems)
   ```

3. **继续开发**
   - 移除测试按钮（如果需要）
   - 实现数据加载状态
   - 优化用户体验

---

## 🎉 完成！

测试成功后，你的小程序就可以从 Supabase 数据库获取真实数据了！

如有问题，请查看 `Supabase连接测试指南.md` 获取详细帮助。

